@model Pizzeria_Toscana.Models.Cos

@{
    ViewData["Title"] = "Cos";
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="~/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/atisawd/boxicons@2.0.7/css/boxicons.min.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" type="image/svg+xml" href="https://unpkg.com/boxicons@2.1.4/svg/solid/bxs-cart-add.svg">

</head>
<body class="cos-body">
    <header class="header-nav">
        <nav class="navbar">
            <a href="@Url.Action("Index", "Home")" class="
">
                <img src="~/imagini/LogoToscana.png" alt="Logo Pizzeria Toscana">
            </a>
            <a href="@Url.Action("Index", "Meniu")"><i class='bx bxs-food-menu'></i>Meniu</a>
            <a href="@Url.Action("Index", "Cos")"><i class="fa fa-shopping-cart"></i>Cos</a>
            <a href="@Url.Action("Index", "IstoricComenzi")"><i class="fa fa-history"></i>IstoricComenzi</a>

            <a href="@Url.Page("/Account/Manage/Index", new { area = "Identity" })"><i class="bx bx-cog"></i>Setari</a>
        </nav>
        <div class="">
            <partial name="_LoginPartial" />

        </div>
    </header>
    <h1 class="cos-cumparaturi">Cos de Cumparaturi</h1>
    <div>
        <p class="cos-p">Aici vei putea vizualiza și gestiona produsele din coșul tău de cumpărături.</p>
    </div>
    <div class="elements-cos">
        @if (Model.CosProdus != null && Model.CosProdus.Count > 0)
        {
            foreach (var produs in Model.CosProdus)
            {
                <div class="item-cos">
                    <img src="data:image/png;base64,@(produs.Produs?.ProdusPicture != null ? Convert.ToBase64String(produs.Produs.ProdusPicture) : "")" alt="@produs.Produs?.Denumire" />
                    <h3>@(produs.Produs?.Denumire ?? "Produs necunoscut")</h3>
                    <form asp-action="UpdateQuantity" method="post" style="display: flex; align-items: center; gap: 10px;">
                        <input type="hidden" name="codProdus" value="@produs.COD_Produs" />

                        <button type="submit" name="actionType" value="decrease" style="border: none; margin-left: 5rem; background: #ff6b81; padding: 5px 10px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; color: white;">-</button>
                        <p style="margin: 0; font-weight: bold;">@produs.Cantitate</p>

                        <button type="submit" name="actionType" value="increase" style="border: none; background: #28a745; padding: 5px 10px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; color: white;">+</button>
                    </form>

                    <p><strong>Preț Total:</strong> @(produs.Cantitate * produs.Pret) lei</p>

                    <form asp-action="Delete" method="post">
                        <input type="hidden" name="codProdus" value="@produs.COD_Produs" />
                        <button type="submit" class="delete-btn">Șterge</button>
                    </form>
                </div>
            }
        }
        else
        {
            <p>Coșul este gol.</p>
        }
    </div>

    <div>
        <p><strong>Total General:</strong> @(Model.CosProdus?.Sum(item => item.Cantitate * item.Pret) ?? 0) lei</p>
    </div>
    <div class="button-container">
        <a href="@Url.Action("AddMore")" class="btn">Adaugă mai multe produse</a>
        <form asp-action="SubmitOrder" method="post">
            <button type="submit" class="btn">Finalizează Comanda</button>
        </form>

    </div>
</body>
</html>